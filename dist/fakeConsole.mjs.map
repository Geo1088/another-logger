{"version":3,"file":"fakeConsole.mjs","sources":["../src/fakeConsole.ts"],"sourcesContent":["// Eventually we'll use a fake console for more stuff, for now this file just\n// has the table routine\n\nimport { Writable as WritableStream } from \"stream\";\nimport { Console } from \"console\";\n\nexport function captureConsole(func: (capturedConsole: Console) => void) {\n\t// Create an output stream that adds all the data sent to it to a string,\n\t// and patch it so the console will think it has the same color capability\n\t// as process.stdout\n\tlet outputData = '';\n\tconst outputStream = Object.assign(new WritableStream({\n\t\twrite(chunk, encoding, next) {\n\t\t\toutputData += chunk;\n\t\t\tnext();\n\t\t}\n\t}), {\n\t\tisTTY: process.stdout.isTTY,\n\t\tgetColorDepth(...args: any[]) {\n\t\t\treturn process.stdout.getColorDepth(...args)\n\t\t}\n\t});\n\n\t// Create a console that sends its stdout to the output stream\n\tconst fakeConsole = new Console({ stdout: outputStream });\n\n\t// Do something with the fake console\n\tfunc(fakeConsole);\n\n\t// Return the data we recorded\n\treturn outputData;\n}\n\n/**\n * Returns the output of console.table as a string isntead of writing it to\n * stdout.\n * @param   Arguments as passed to `console.table`\n */\nexport function consoleTable(tabularData?: any, properties?: string[]) {\n\treturn captureConsole(c => c.table(tabularData, properties)).replace(/\\n$/, '');\n}\n"],"names":["WritableStream","process"],"mappings":";;;;SAMgB,cAAc,CAAC,IAAwC;;;;IAItE,IAAI,UAAU,GAAG,EAAE,CAAC;IACpB,MAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,IAAIA,QAAc,CAAC;QACrD,KAAK,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI;YAC1B,UAAU,IAAI,KAAK,CAAC;YACpB,IAAI,EAAE,CAAC;SACP;KACD,CAAC,EAAE;QACH,KAAK,EAAEC,SAAO,CAAC,MAAM,CAAC,KAAK;QAC3B,aAAa,CAAC,GAAG,IAAW;YAC3B,OAAOA,SAAO,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,CAAA;SAC5C;KACD,CAAC,CAAC;;IAGH,MAAM,WAAW,GAAG,IAAI,OAAO,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,CAAC;;IAG1D,IAAI,CAAC,WAAW,CAAC,CAAC;;IAGlB,OAAO,UAAU,CAAC;AACnB,CAAC;AAED;;;;;SAKgB,YAAY,CAAC,WAAiB,EAAE,UAAqB;IACpE,OAAO,cAAc,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AACjF;;;;"}